(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30263,        693]
NotebookOptionsPosition[     28643,        660]
NotebookOutlinePosition[     29119,        677]
CellTagsIndexPosition[     29076,        674]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Interactive Molecular Orbital Isosurface Plots", "Subsection",
 CellChangeTimes->{{3.8522022962849483`*^9, 3.8522023112245398`*^9}, 
   3.8522024913550367`*^9},ExpressionUUID->"b76058a8-2021-4ad0-8133-\
a293d442614f"],

Cell["\<\
Jochen Autschbach, University at Buffalo, SUNY. 
(c) 2020-2023 Jochen Autschbach

If you use this notebook for research or educational articles, I would \
appreciate a citation of my textbook, for which I developed this \
functionality: 

Quantum Theory for Chemical Applications, by J. Autschbach. Oxford University \
Press, New York (NY), 2021. 

A related publication is this: https://doi.org/10.1021/ed200673w\
\>", "Text",
 CellChangeTimes->{{3.852202320988123*^9, 3.8522024817629747`*^9}, {
  3.85220251189102*^9, 3.852202519134107*^9}, {3.89290458195798*^9, 
  3.892904589106019*^9}},ExpressionUUID->"c2092725-48ef-4287-963a-\
67fb01c514e5"],

Cell[CellGroupData[{

Cell["\<\
Initialization (no need to open unless you get error messages)\
\>", "Subsubsection",
 CellChangeTimes->{{3.79389059616403*^9, 3.793890613310665*^9}, {
  3.793906112930657*^9, 
  3.793906120737749*^9}},ExpressionUUID->"887e90fc-05f8-4ab0-80f2-\
4496be7a7a90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mmaver", " ", "=", " ", "$VersionNumber"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vp", "=", 
    RowBox[{"ViewPoint", "/.", 
     RowBox[{"Options", "[", "Graphics3D", "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vv", "=", 
   RowBox[{"ViewVertical", "/.", 
    RowBox[{"Options", "[", "Graphics3D", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1.330663566850352`", ",", 
     RowBox[{"-", "2.5950978779126124`"}], ",", "1.7160423875623128`"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vv", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.10980290746198387`"}], ",", "0.3835815004384582`", ",", 
     "0.9169561352836221`"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"themes", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Tubes\>\"", ",", "\"\<HeavyAtom\>\"", ",", "\"\<BallAndStick\>\"", 
     ",", "\"\<Spacefilling\>\"", ",", "\"\<Wireframe\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"export", " ", "=", " ", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"mmaver", " ", "==", " ", "13.3"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"for", " ", "version", " ", "13.3"}], ",", " ", 
      RowBox[{
      "we", " ", "need", " ", "this", " ", "version", " ", "to", " ", 
       "import", " ", "the", " ", "molecular", " ", "structure", " ", "an", 
       " ", 
       RowBox[{"image", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", "\"\<init: using v. 13.3 hack for molecule plot\>\"", 
     "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{" ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"July", " ", "2023"}], ":", " ", 
        RowBox[{
        "customImporter", " ", "function", " ", "originally", " ", "came", 
         " ", "from", " ", "Oliver", " ", "Jandette", " ", "at", " ", 
         "Wolfram", " ", "Tech", " ", "support", " ", "when", " ", "I", " ", 
         "reported", " ", "that", " ", "the", " ", 
         "\"\<InferBondTypes\>\""}]}], "->", " ", 
       RowBox[{
        RowBox[{
        "False", " ", "import", " ", "option", " ", "for", " ", "XYZ", " ", 
         "and", " ", "other", " ", "molecule", " ", "formats", " ", "stopped",
          " ", "working", " ", "in", " ", 
         RowBox[{"13.3", ".", " ", 
          RowBox[{"Thanks", "!"}]}], " ", "I", " ", "added", " ", "the", " ", 
         "Triple", " ", "and", " ", "Aromatic", " ", "bond", " ", 
         "substitutions", " ", "and", " ", "I", " ", "also", " ", "had", " ", 
         "to", " ", "add", " ", "that", " ", "ugly", " ", "hack", " ", "with",
          " ", "the", " ", "ValenceFilling"}], "->", 
        RowBox[{"None", " ", "option"}]}]}], ",", " ", 
      RowBox[{
      "otherwise", " ", "Mathematica", " ", "will", " ", "add", " ", 
       "hydrogens", " ", "to", " ", "the", " ", "molecule", " ", "to", " ", 
       "cap", " ", "dangling", " ", "valencies"}], ",", " ", 
      RowBox[{
       RowBox[{
       "which", " ", "is", " ", "something", " ", "we", " ", "do", " ", "not",
         " ", 
        RowBox[{"want", ".", "\[IndentingNewLine]", "August"}], " ", "2023"}],
        ":", " ", 
       RowBox[{"For", " ", "some", " ", "molecules"}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "there", " ", "is", " ", "an", " ", "additional", " ", "setting", " ", 
        "in", " ", "the", " ", "molecule", " ", "specification", " ", "when", 
        " ", "importing", " ", "XYZ", " ", "while", " ", "looks", " ", "like",
         " ", 
        RowBox[{
        "this", ":", "\[IndentingNewLine]", "StereochemistryElements"}]}], 
       " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<StereoType\>\"", " ", "->", " ", 
           RowBox[{
           "\"\<DoubleBond\>\"", "\[IndentingNewLine]", "so", " ", 
            "replacing", " ", "\"\<Double\>\"", " ", "with", " ", 
            "\"\<Single\>\"", " ", "will", " ", "interfere", " ", "and", " ", 
            "cause", " ", "an", " ", 
            RowBox[{"error", ".", " ", "The"}], " ", "workaround", " ", "for",
             " ", "that", " ", "is", " ", "to", " ", "replace", " ", 
            "\"\<Double\>\""}]}], ",", " ", "\"\<Triple\>\"", ",", " ", 
          RowBox[{
           RowBox[{"etc", ".", " ", "with"}], " ", "\"\<Single\>\"", " ", 
           "including", " ", "the", " ", 
           RowBox[{"quotes", ".", " ", "I"}], " ", "also", " ", "had", " ", 
           "to", " ", "make", " ", "sure", " ", "that", " ", "the", " ", 
           "ValenceFilling", " ", "option", " ", "only", " ", "replaces", " ",
            "the", " ", "last", " ", "closing", " ", "bracket"}]}], 
         " "}]}]}]}], "]"}], " ", "in", " ", "the", " ", "string", " ", 
    "because", " ", "otherwise", " ", "the", " ", "replacement", " ", 
    "pattern", " ", "would", " ", "not", " ", "work", " ", "in", " ", "some", 
    " ", 
    RowBox[{"cases", "."}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"customImporter", "[", 
    RowBox[{"path_", ",", " ", "theme_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mol", ",", "textmol", ",", "goodmol"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mol", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"path", ",", "\"\<Molecule\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"textmol", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"InputForm", "[", "mol", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"goodmol", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"textmol", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<\\\"Double\\\"\>\"", "->", "\"\<\\\"Single\\\"\>\""}], ",", 
            RowBox[{
            "\"\<\\\"Triple\\\"\>\"", "->", "\"\<\\\"Single\\\"\>\""}], ",", 
            RowBox[{
            "\"\<\\\"Aromatic\\\"\>\"", "->", "\"\<\\\"Single\\\"\>\""}], ",", 
            RowBox[{
             RowBox[{"\"\<]\>\"", " ", "~~", " ", "EndOfString"}], " ", "->", 
             " ", "\"\<, ValenceFilling->None]\>\""}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Graphics3D\>\"", "->", 
         RowBox[{"MoleculePlot3D", "[", 
          RowBox[{"goodmol", ",", 
           RowBox[{"PlotTheme", "->", "theme"}]}], "]"}]}], ",", 
        RowBox[{"\"\<Molecule\>\"", "->", "goodmol"}]}], "|>"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cubeplot", "[", 
    RowBox[{
    "cubefile_", ",", "contours_", ",", "plottheme_", ",", "mesh_", ",", 
     "invert_"}], "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cube", ",", "tmp", ",", "mol", ",", "vol", ",", "molplot", ",", 
       "cgraf", ",", "file", ",", "\[IndentingNewLine]", 
       RowBox[{"opa", " ", "=", " ", "0.7"}], ",", " ", 
       RowBox[{"spec", " ", "=", " ", "50"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"pluss", " ", "=", " ", 
        RowBox[{"ColorData", "[", 
         RowBox[{"\"\<RedBlueTones\>\"", ",", "0.05"}], "]"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"minuss", " ", "=", 
        RowBox[{"ColorData", "[", 
         RowBox[{"\"\<RedBlueTones\>\"", ",", "0.75"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"sign", " ", "=", " ", "1"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sign", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"invert", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cubefile", " ", "\[Equal]", " ", "\"\<None\>\""}], ",", 
        "\"\<Please select cube from drop-down menu\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cube", "=", "cubefile"}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{"Import", "[", 
           RowBox[{"cube", ",", "\"\<Cube\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"file", " ", "=", " ", "\"\<molecule.xyz\>\""}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{"file", ",", "tmp"}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"mmaver", " ", "==", " ", "13.3"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"for", " ", "version", " ", "13.3"}], ",", " ", 
             RowBox[{
             "we", " ", "need", " ", "this", " ", "version", " ", "to", " ", 
              "import", " ", "the", " ", "molecular", " ", "structure", " ", 
              "as", " ", "an", " ", 
              RowBox[{"image", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"molplot", " ", "=", " ", 
             RowBox[{
              RowBox[{"customImporter", "[", 
               RowBox[{"file", ",", "plottheme"}], "]"}], "[", 
              "\"\<Graphics3D\>\"", "]"}]}], ";"}], " ", 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "original", " ", "code", " ", "displaying", " ", "the", " ", 
             RowBox[{"molecule", ":"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mol", " ", "=", " ", 
             RowBox[{"Import", "[", 
              RowBox[{"file", ",", 
               RowBox[{"\"\<InferBondTypes\>\"", "\[Rule]", "False"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"molplot", " ", "=", " ", 
             RowBox[{"MoleculePlot3D", "[", 
              RowBox[{"mol", ",", 
               RowBox[{"PlotTheme", "\[Rule]", "plottheme"}]}], "]"}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"DeleteFile", "[", "file", "]"}], ";"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"vol", " ", "=", " ", 
          RowBox[{"Import", "[", 
           RowBox[{"cube", ",", "\"\<VolumetricData\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cgraf", " ", "=", " ", 
          RowBox[{"ListContourPlot3D", "[", 
           RowBox[{
            RowBox[{"vol", "[", 
             RowBox[{"[", 
              RowBox[{"\"\<Data\>\"", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"vol", "[", "\"\<DataRange\>\"", "]"}]}], ",", 
            RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"Contours", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "sign"}], " ", "contours"}], ",", 
               RowBox[{"sign", " ", "contours"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ContourStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"minuss", ",", 
                 RowBox[{"Opacity", "[", "opa", "]"}], "\[IndentingNewLine]", 
                 ",", " ", 
                 RowBox[{"Specularity", "[", 
                  RowBox[{"White", ",", "spec"}], "]"}]}], " ", 
                "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"Directive", "[", 
                RowBox[{"pluss", ",", 
                 RowBox[{"Opacity", "[", "opa", "]"}], "\[IndentingNewLine]", 
                 " ", ",", " ", 
                 RowBox[{"Specularity", "[", 
                  RowBox[{"White", ",", "spec"}], "]"}]}], " ", "]"}]}], 
              "}"}]}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Boxed", "\[Rule]", "False"}], ",", " ", 
            RowBox[{"BoxStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Thickness", "[", "0.01", "]"}], ",", "Gray"}], 
              "]"}]}], ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"Mesh", "\[Rule]", "mesh"}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", "None"}], ",", 
            RowBox[{"Ticks", "\[Rule]", "None"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"combo", " ", "=", " ", 
          RowBox[{"Show", "[", 
           RowBox[{"cgraf", ",", "molplot", ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ViewPoint", "\[Rule]", 
             RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ViewVertical", "\[Rule]", " ", 
             RowBox[{"Dynamic", "[", "vv", "]"}]}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"expfile", "[", "cubefile_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "outfile", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outfile", " ", "=", " ", 
      RowBox[{"StringReverse", "[", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"StringReverse", "[", "cubefile", "]"}], ",", 
         RowBox[{
          RowBox[{"StringReverse", "[", 
           RowBox[{"\"\<.\>\"", "<>", "ext"}], "]"}], " ", "\[Rule]", " ", 
          RowBox[{"StringReverse", "[", "\"\<.png\>\"", "]"}]}], ",", "1"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"outfile", ",", "combo", ",", "\"\<PNG\>\"", ",", 
       RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Run", "[", 
      RowBox[{"\"\<mogrify -trim \>\"", "<>", "outfile"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.79378790529633*^9, 3.7937879261375113`*^9}, 
   3.793889893035323*^9, {3.793890579863617*^9, 3.7938905806137877`*^9}, {
   3.7938915850352287`*^9, 3.79389160113636*^9}, {3.793891633163087*^9, 
   3.7938916940978813`*^9}, {3.7938927501957417`*^9, 3.793892811852044*^9}, {
   3.793906305425322*^9, 3.793906435889758*^9}, {3.793976330455872*^9, 
   3.793976331365882*^9}, 3.7942429515874662`*^9, {3.892904130155116*^9, 
   3.892904134011157*^9}, {3.89290421073228*^9, 3.892904217552795*^9}, {
   3.8929042740705023`*^9, 3.892904276184087*^9}, {3.897997927498951*^9, 
   3.8979980512027617`*^9}, {3.8979981149338837`*^9, 3.897998195127516*^9}, {
   3.897998342572885*^9, 3.89799834698428*^9}, {3.898000394985293*^9, 
   3.8980003961720953`*^9}, 3.898000573515905*^9, {3.898000853076675*^9, 
   3.898000945343433*^9}, {3.898006772045351*^9, 3.89800681642772*^9}, {
   3.898006858739362*^9, 3.8980068973287783`*^9}, 3.89800708875441*^9, {
   3.89800713068395*^9, 3.898007161218463*^9}, {3.898007226357491*^9, 
   3.898007257902441*^9}, 3.898007293473557*^9, {3.898007359093483*^9, 
   3.898007391807288*^9}, {3.898007427174919*^9, 3.8980074719254923`*^9}, {
   3.8980076058075438`*^9, 3.898007653683255*^9}, {3.900404840603532*^9, 
   3.900404871723235*^9}, {3.900404984038065*^9, 3.900405022062933*^9}, {
   3.900666509880637*^9, 3.9006665397506104`*^9}, {3.900666591041041*^9, 
   3.900666704859974*^9}, 3.900666845734426*^9, {3.9007913367618923`*^9, 
   3.900791338448319*^9}, {3.900791575829671*^9, 3.9007915866305313`*^9}, {
   3.900791638755246*^9, 3.90079166853266*^9}, 3.9007917034280643`*^9, {
   3.9010135617698793`*^9, 3.901013681722309*^9}, {3.901013733994616*^9, 
   3.901013734902652*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"724f81ef-ce85-4e6f-a7c6-06c24428f6a6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Define Cube file list and run Plot & Export Panel", "Subsubsection",
 CellChangeTimes->{{3.793890619809799*^9, 
  3.793890640825129*^9}},ExpressionUUID->"36456696-7c0f-4d6f-b97d-\
025213ba313e"],

Cell[TextData[{
 "Execute cells with \[ShiftKey] + \[EnterKey]\n\nThe next cell of commands \
makes a list of cube files from the directory containing the notebook. The \
file name extension (.cub or .cube, usually) needs to be defined first. ",
 StyleBox["The cube files must all be for the same molecule and the same \
volume data grid; otherwise you should expect unintended affects and errors.\n\
",
  FontSlant->"Italic"],
 "\n",
 StyleBox["Warning: ",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["the code underlying the interactive panel below will create \na \
file named \[OpenCurlyQuote]molecule.xyz\[CloseCurlyQuote], an xyz-format \
molecular coordinate file\nthat gets extracted from the cube file selected \
for visualization. Do not run\nthe visualization code if you have a file \
\[OpenCurlyQuote]molecule.xyz\[CloseCurlyQuote] in the notebook\
\[CloseCurlyQuote]s\ndirectory and don\[CloseCurlyQuote]t want it to get \
replaced.",
  FontSize->14],
 "\n\n",
 StyleBox["Comment:",
  FontColor->RGBColor[0.5, 0, 0.5]],
 " ",
 StyleBox["The cube files may come from a software that generates files with \
names containing special characters or blanks. Better to remove them first, \
e.g. with (the command replaces blanks, $, @, % with _):\nrename  \
\[OpenCurlyQuote]s/ |\\$|@|%/_/g\[CloseCurlyQuote] *.cub ",
  FontSize->14]
}], "Text",
 CellChangeTimes->{{3.793799563306443*^9, 3.793799591542831*^9}, {
  3.793800247320668*^9, 3.793800274450728*^9}, {3.793811232515476*^9, 
  3.79381124830521*^9}, {3.793877291554789*^9, 3.79387730603856*^9}, {
  3.793891851526307*^9, 3.793891862733467*^9}, {3.7938919262347097`*^9, 
  3.7938919455726852`*^9}, {3.7938919886953897`*^9, 3.793892000515251*^9}, {
  3.793899963329277*^9, 3.793899964123254*^9}, {3.793905191015929*^9, 
  3.793905246133747*^9}, {3.793906027563292*^9, 3.7939060580030327`*^9}, {
  3.852197921866893*^9, 3.8521979799009*^9}, {3.85220216131085*^9, 
  3.852202257066807*^9}, {3.852202539743265*^9, 3.852202580916294*^9}, {
  3.892904298821944*^9, 3.8929044263496532`*^9}, {3.892904480780119*^9, 
  3.892904545429339*^9}, {3.89290517838025*^9, 3.892905184678684*^9}, {
  3.900667540185666*^9, 
  3.90066754330694*^9}},ExpressionUUID->"bcf1db58-0c2a-43cd-a28e-\
7e8276321f48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ext", " ", "=", " ", "\"\<cube\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flist", " ", "=", " ", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*.\>\"", "<>", "ext"}], "]"}], ",", "\"\<None\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"flist", "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.7938042412340117`*^9, 3.7938042666952047`*^9}, {
   3.79380956574901*^9, 3.793809567368286*^9}, {3.793877310133439*^9, 
   3.793877327454195*^9}, {3.793889228672031*^9, 3.7938892456917048`*^9}, {
   3.793899826772191*^9, 3.793899836917363*^9}, {3.79389988807288*^9, 
   3.793899916506937*^9}, 3.794241133020411*^9, 3.79424168587214*^9, 
   3.852197362819961*^9, {3.852197427472699*^9, 3.852197429030765*^9}, {
   3.8521975165186*^9, 3.8521975376840267`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"27727f97-7dd2-4d31-a480-915518d89fa6"],

Cell["\<\
Plot, rotate, and export to PNG. Tip: You can hide the code below after \
executing the Manipulate command by double-clicking the output cell bracket \
on the right \
\>", "Text",
 CellChangeTimes->{{3.793890669414953*^9, 3.7938906751484528`*^9}, {
  3.900667167725882*^9, 3.900667218381531*^9}, {3.900667409527567*^9, 
  3.9006674253109627`*^9}, {3.900667476057292*^9, 3.900667508585528*^9}, {
  3.9010137987070417`*^9, 
  3.901013805210429*^9}},ExpressionUUID->"f777762c-fa40-4a94-805b-\
65d60eaa92db"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"export", ",", 
      RowBox[{"expfile", "[", "cubefile", "]"}]}], "]"}], ";", " ", 
    RowBox[{"export", " ", "=", " ", "False"}], ";", "\[IndentingNewLine]", 
    RowBox[{"cubeplot", "[", 
     RowBox[{
     "cubefile", ",", "contours", ",", "plottheme", ",", "mesh", ",", 
      "invert"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cubefile", ",", 
       RowBox[{"flist", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Cube File\>\""}], "}"}], 
     ",", "flist", ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plottheme", ",", 
       RowBox[{"themes", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Molecule Style\>\""}], 
      "}"}], ",", "themes", ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"contours", ",", "0.03", ",", "\"\<Iso Value\>\""}], "}"}], ",",
      "0.03"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mesh", ",", "True", ",", "\"\<Show Mesh\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"invert", ",", "False", ",", "\"\<Invert Phase\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Export to PNG (be patient)\>\"", ",", " ", 
     RowBox[{"export", " ", "=", " ", "True"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ3RMSftrR5Y3j8aKZV0H06syUOyA6Rfj2fRDdtST7
CYi+sEzmKYh+v4rpPYi+8kv/M4hmXPw7zQlI8wjdyAfRH+f8qgPRWVvM6kF0
y26hFhDdxd/RAaKzn0yYBqLX/BOfC6LXvWA+BqJfy8ieBNFTk2MOuQDpkPhf
10F0C7+9hiuQfl43G0y3cxXogGgJ51oDED1hy2czEJ3jf8ocRAuVr0gE0d6t
4mkgesHfbTkgWoTTtgBEe3RZdIDoEKZdnSD60szrE0H0nSazqSDaJd/7BYh+
ZrTmJYhO+3bzHYh2qv72BURv8frJ4wayb1mrBIjWXhy65R3/W8ew9bHbQTQA
UBehbg==
  "],
 CellLabel->"In[16]:=",ExpressionUUID->"27d66299-0a14-41eb-95a5-8d0f01135a5a"],

Cell["\<\
Evaluate the next cell in case you want to re-use the viewpoint settings. The \
listed values for ViewPoint and ViewVerical will be replaced with the current \
values. You can set vp and vv in another notebook to these values, if needed, \
or import the relevant data from a similar file created by another notebook. \
\
\>", "Text",
 CellChangeTimes->{{3.7938894969785748`*^9, 3.793889514952859*^9}, {
  3.793890546158038*^9, 3.7938905592948837`*^9}, {3.793890766083115*^9, 
  3.793890766383963*^9}, {3.793893926642372*^9, 3.79389400791328*^9}, {
  3.7939065066894712`*^9, 3.793906514280078*^9}, {3.7939070320747337`*^9, 
  3.7939070331141853`*^9}, {3.852197695429*^9, 
  3.852197729894226*^9}},ExpressionUUID->"c1b76068-cef1-4f95-b6e5-\
2be7d652dc17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Export", " ", "Viewpoint"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vpp", " ", "=", " ", "vp"}], "\[IndentingNewLine]", 
   RowBox[{"vvp", " ", "=", " ", "vv"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "=", "\"\<viewpoint.dat\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "f", "]"}], ",", 
      RowBox[{"DeleteFile", "[", "f", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"file", "=", 
    RowBox[{"CreateFile", "[", "f", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Write", "[", 
     RowBox[{
      RowBox[{"File", "[", "file", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"vpp", ",", "vvp"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Close", "[", 
     RowBox[{"File", "[", "file", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.793888638182845*^9, 3.793888638507969*^9}, {
  3.793889520258791*^9, 3.793889525723485*^9}, {3.793906477287516*^9, 
  3.793906522347354*^9}, {3.793906649499798*^9, 3.793906672413499*^9}, {
  3.793906731944075*^9, 3.793906751677137*^9}, {3.79390684476763*^9, 
  3.793906951032813*^9}, {3.793906993923893*^9, 3.79390701077602*^9}, {
  3.7939079022073393`*^9, 3.793907910759103*^9}, {3.793907976070784*^9, 
  3.793907994705652*^9}, {3.793908449538348*^9, 3.793908452080345*^9}, {
  3.7939097014086437`*^9, 3.793909703695759*^9}, {3.79390975901891*^9, 
  3.793909761494224*^9}, {3.852198036574634*^9, 
  3.852198042818246*^9}},ExpressionUUID->"b2b39270-b79b-4f2a-803c-\
9a35b06d731e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Import", " ", "Viewpoint"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "=", "\"\<viewpoint-other.dat\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"dat", " ", "=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ReadList", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}], ",", "2"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"vp", " ", "=", " ", 
    RowBox[{"dat", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"vv", " ", "=", " ", 
    RowBox[{"dat", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7939081038907547`*^9, 3.79390813280492*^9}, {
  3.793908166664557*^9, 3.793908173265201*^9}, {3.79390822212689*^9, 
  3.793908232439907*^9}, {3.7939083067441*^9, 3.7939083363325653`*^9}, {
  3.793908483816798*^9, 3.793908503345669*^9}, {3.793908572466937*^9, 
  3.793908579377406*^9}, {3.7939086664980097`*^9, 3.793908671545442*^9}, {
  3.7939087095776777`*^9, 3.7939087106874533`*^9}, {3.793909633479909*^9, 
  3.79390964055342*^9}, {3.793909723133286*^9, 3.793909747506981*^9}, {
  3.79424269919637*^9, 3.794242699882577*^9}, {3.852197735606139*^9, 
  3.8521977377157803`*^9}, {3.85219804625914*^9, 
  3.852198052386878*^9}},ExpressionUUID->"a722bb31-346c-403a-a4f4-\
24561304b156"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{723.75, 639},
WindowMargins->{{Automatic, 217.5}, {56.25, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"13.3 for Linux x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a2dec52c-66a9-4cfd-b696-94e91a0df321"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 223, 3, 54, "Subsection",ExpressionUUID->"b76058a8-2021-4ad0-8133-a293d442614f"],
Cell[806, 27, 658, 16, 242, "Text",ExpressionUUID->"c2092725-48ef-4287-963a-67fb01c514e5"],
Cell[CellGroupData[{
Cell[1489, 47, 269, 6, 45, "Subsubsection",ExpressionUUID->"887e90fc-05f8-4ab0-80f2-4496be7a7a90"],
Cell[1761, 55, 16578, 363, 1897, "Input",ExpressionUUID->"724f81ef-ce85-4e6f-a7c6-06c24428f6a6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[18376, 423, 200, 3, 37, "Subsubsection",ExpressionUUID->"36456696-7c0f-4d6f-b97d-025213ba313e"],
Cell[18579, 428, 2249, 42, 396, "Text",ExpressionUUID->"bcf1db58-0c2a-43cd-a28e-7e8276321f48"],
Cell[20831, 472, 954, 19, 70, "Input",ExpressionUUID->"27727f97-7dd2-4d31-a480-915518d89fa6"],
Cell[21788, 493, 514, 10, 58, "Text",ExpressionUUID->"f777762c-fa40-4a94-805b-65d60eaa92db"],
Cell[22305, 505, 2424, 63, 228, "Input",ExpressionUUID->"27d66299-0a14-41eb-95a5-8d0f01135a5a"],
Cell[24732, 570, 763, 13, 104, "Text",ExpressionUUID->"c1b76068-cef1-4f95-b6e5-2be7d652dc17"],
Cell[25498, 585, 1687, 38, 190, "Input",ExpressionUUID->"b2b39270-b79b-4f2a-803c-9a35b06d731e"],
Cell[27188, 625, 1427, 31, 112, "Input",ExpressionUUID->"a722bb31-346c-403a-a4f4-24561304b156"]
}, Open  ]]
}, Open  ]]
}
]
*)

