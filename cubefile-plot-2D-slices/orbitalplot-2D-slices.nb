(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     77890,       1684]
NotebookOptionsPosition[     74154,       1610]
NotebookOutlinePosition[     74780,       1634]
CellTagsIndexPosition[     74703,       1629]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Orbital Plots in 2D Slices (Cut-Planes) from Cube Format Import\
\>", "Section",
 CellChangeTimes->{{3.897726730675234*^9, 3.897726760235175*^9}, {
  3.91416238963443*^9, 3.914162408482318*^9}, {3.914170575940013*^9, 
  3.91417059842293*^9}, {3.914773272811502*^9, 3.9147732860893097`*^9}, {
  3.9153626979562473`*^9, 3.915362699197007*^9}, {3.915362845796365*^9, 
  3.915362848798174*^9}},ExpressionUUID->"9f8841a8-8249-4f47-9d55-\
d95cc146c0e1"],

Cell[CellGroupData[{

Cell["Copyright, License, Relevant Literature, Notes", "Subsubsection",
 CellChangeTimes->{{3.914773101401758*^9, 3.914773112368757*^9}, {
  3.915536382442329*^9, 3.915536384509364*^9}, {3.91762756401923*^9, 
  3.9176275693851137`*^9}},ExpressionUUID->"519384ab-5ac3-490a-ad9d-\
5bb2de8040a7"],

Cell[TextData[{
 "\[Copyright] 2024 Jochen Autschbach\n\nLiterature: \n\n[1] Pierpaolo \
Morgante & Jochen Autschbach, ",
 StyleBox["Molecular Orbitals",
  FontSlant->"Italic"],
 ", American Chemical Society, Washington, DC, 2023.\n\nSee file LICENSE in \
https://github.com/jautschbach/mathematica-notebooks for license information \
and disclaimers."
}], "Text",
 CellChangeTimes->{{3.874491401677493*^9, 3.874491484594095*^9}, {
  3.874491975049707*^9, 3.874491984906625*^9}, {3.914773121878868*^9, 
  3.914773123538113*^9}, {3.9147731617833443`*^9, 3.91477317812821*^9}, {
  3.915536388723558*^9, 
  3.915536389552313*^9}},ExpressionUUID->"014379ae-42bf-4be7-bb3c-\
9629767445a6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Description", "Subsubsection",
 CellChangeTimes->{{3.915532068707152*^9, 
  3.915532070737084*^9}},ExpressionUUID->"2c40b424-c9f6-4b94-9b1c-\
ae24b2b092e4"],

Cell["\<\
Visualization of molecular volume data in CUBE format, specifically, \
visualization of the data in 2D slices (cut-planes). An earlier version of \
this notebook was used to create some of the orbital visualizations from \
quantum chemistry calculations shown in reference [1] that feature cut-plane \
contours. The functionality has been significantly extended since that first \
version and now also allows plotting several contour sets from different cube \
files (same molecule, of course) in a single plot, for example, to \
demonstrate how atomic orbitals overlap.

If you use this notebook, or code based on it, for your own research, please \
cite reference [1] provided in the \[OpenCurlyDoubleQuote]Copyright, License, \
relevant Literature\[CloseCurlyDoubleQuote] section and provide the URL from \
where you obtained this notebook.\
\>", "Text",
 CellChangeTimes->{{3.840290754199389*^9, 3.840290863751519*^9}, {
  3.840290915420718*^9, 3.840290943863029*^9}, {3.840291280809177*^9, 
  3.840291281936075*^9}, {3.840291317304593*^9, 3.840291357072824*^9}, {
  3.8522055446414757`*^9, 3.852205559593772*^9}, {3.915532085830104*^9, 
  3.915532132874722*^9}, {3.915532201621814*^9, 3.915532282973084*^9}, {
  3.915533423885158*^9, 3.915533459046907*^9}, {3.915534037217362*^9, 
  3.915534152306849*^9}, {3.915534206728109*^9, 3.915534358280931*^9}, {
  3.917627576504809*^9, 
  3.9176276034329977`*^9}},ExpressionUUID->"9983541e-6292-4630-97dc-\
e2e68b752b6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Initialization cells (no need to open unless you get error messages)\
\>", "Subsubsection",
 CellChangeTimes->{{3.897727948030819*^9, 3.897727962379978*^9}, {
   3.914418866458927*^9, 3.914418870939124*^9}, 3.914420238925591*^9, {
   3.914773239959224*^9, 3.914773251233214*^9}, {3.915533347465291*^9, 
   3.9155333477321444`*^9}},ExpressionUUID->"94e934e5-f4d3-4966-865f-\
84d12904cdeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colors", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ColorData", "[", 
      RowBox[{"\"\<RedBlueTones\>\"", ",", "0.15"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ColorData", "[", 
      RowBox[{"\"\<RedBlueTones\>\"", ",", "0.80"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ColorData", "[", 
      RowBox[{"\"\<GreenPinkTones\>\"", ",", "0.15"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ColorData", "[", 
      RowBox[{"\"\<SolarColors\>\"", ",", "0.70"}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vp", "=", 
    RowBox[{"ViewPoint", "/.", 
     RowBox[{"Options", "[", "Graphics3D", "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vv", "=", 
   RowBox[{"ViewVertical", "/.", 
    RowBox[{"Options", "[", "Graphics3D", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"customImporter", "[", "path_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"textmol", ",", "goodmol"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"mol", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"path", ",", "\"\<Molecule\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"textmol", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"InputForm", "[", "mol", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"goodmol", "=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"textmol", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<\\\"Double\\\"\>\"", "->", "\"\<\\\"Single\\\"\>\""}], ",", 
            RowBox[{
            "\"\<\\\"Triple\\\"\>\"", "->", "\"\<\\\"Single\\\"\>\""}], ",", 
            RowBox[{
            "\"\<\\\"Aromatic\\\"\>\"", "->", "\"\<\\\"Single\\\"\>\""}], ",", 
            RowBox[{
             RowBox[{"\"\<]\>\"", " ", "~~", " ", "EndOfString"}], " ", "->", 
             " ", "\"\<, ValenceFilling->None]\>\""}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "goodmol", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"(*", " ", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Create contours (may take a while...) \>\"", ",", 
     RowBox[{"NotebookEvaluate", "[", 
      RowBox[{
       RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
       RowBox[{"EvaluationElements", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Tags\>\"", "\[Rule]", 
          RowBox[{"{", "\"\<make-contours\>\"", "}"}]}], "}"}]}]}], "]"}], 
     ",", 
     RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], "  ", 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.793798633045143*^9, 3.793798633638342*^9}, 
   3.7937990332118587`*^9, {3.793799423835637*^9, 3.793799424429448*^9}, {
   3.793812876199871*^9, 3.793812900248032*^9}, {3.793976150994787*^9, 
   3.793976165907461*^9}, {3.794059191446529*^9, 3.794059194288357*^9}, {
   3.864745050559181*^9, 3.864745067185685*^9}, {3.864808832517955*^9, 
   3.864808834174582*^9}, {3.914165312024158*^9, 3.914165327972855*^9}, {
   3.914165379930373*^9, 3.91416539992756*^9}, {3.914165607973052*^9, 
   3.914165615118895*^9}, {3.914174052076466*^9, 3.914174065044384*^9}, {
   3.914187579686805*^9, 3.914187585540912*^9}, {3.9141882653084583`*^9, 
   3.914188269047246*^9}, {3.914241946626474*^9, 3.9142419570866413`*^9}, {
   3.914242521536366*^9, 3.9142425240892563`*^9}, {3.914242629807714*^9, 
   3.914242632505574*^9}, {3.9144188017020607`*^9, 3.9144188222826443`*^9}, {
   3.914774247185214*^9, 3.914774260811167*^9}, {3.91502128921075*^9, 
   3.9150212973280497`*^9}, {3.915041331769065*^9, 3.915041332488504*^9}, {
   3.915041409407631*^9, 3.915041415648554*^9}, {3.915041495819022*^9, 
   3.915041519787924*^9}, {3.9150428105189657`*^9, 3.9150428111287127`*^9}, {
   3.91536297279874*^9, 3.915363002484666*^9}, {3.91536899663515*^9, 
   3.915369001339213*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"bbc363e6-aa4c-4ecc-94c7-18f0dc84cfd9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Make a list of cube files from the current directory (use \[ShiftKey]+\
\[EnterKey] to evaluate cells after placing cursor in them) \
\>", "Subsubsection",
 CellChangeTimes->{{3.793799563306443*^9, 3.793799591542831*^9}, {
   3.793800247320668*^9, 3.793800274450728*^9}, {3.793811232515476*^9, 
   3.79381124830521*^9}, {3.853931060129483*^9, 3.853931103966256*^9}, {
   3.853931466272396*^9, 3.853931472178119*^9}, {3.897727982035624*^9, 
   3.897727986653781*^9}, 3.897728605369555*^9, {3.914418885632975*^9, 
   3.914418887218624*^9}, {3.9147762392607317`*^9, 3.914776244829646*^9}, {
   3.9147762835849237`*^9, 3.914776304329876*^9}, 
   3.915533359877076*^9},ExpressionUUID->"bcf1db58-0c2a-43cd-a28e-\
7e8276321f48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ext", " ", "=", " ", "\"\<cube\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flist", " ", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.\>\"", "<>", "ext"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{"Length", "[", "flist", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableForm", "[", 
   RowBox[{"flist", ",", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", "n", "]"}], ",", 
       RowBox[{"{", "}"}]}], "}"}]}], ",", " ", ",", " ", 
    RowBox[{"TableAlignments", "\[Rule]", "Left"}]}], "]"}], " "}]}], "Input",\

 CellChangeTimes->{{3.7938042412340126`*^9, 3.793804266695205*^9}, {
   3.79380956574901*^9, 3.793809567368286*^9}, {3.7939761838798842`*^9, 
   3.793976217010746*^9}, {3.864571166434132*^9, 3.864571169008116*^9}, 
   3.864708210767799*^9, 3.864808779728314*^9, {3.914171137737555*^9, 
   3.91417122723062*^9}, {3.914171264975856*^9, 3.9141713111266627`*^9}, {
   3.9141713966457453`*^9, 3.914171400580159*^9}, {3.9141714715995626`*^9, 
   3.914171484428393*^9}, {3.914171544739452*^9, 3.914171566057569*^9}, {
   3.914171668652194*^9, 3.91417166965993*^9}, 3.915020647718474*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"27727f97-7dd2-4d31-a480-915518d89fa6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pick cubes to plot", "Subsubsection",
 CellChangeTimes->{{3.9144202164039187`*^9, 3.914420262100553*^9}, {
  3.91504211203482*^9, 
  3.9150421137058496`*^9}},ExpressionUUID->"75efccdb-433b-44b3-bce7-\
04474ffb7b28"],

Cell["\<\
Pick one or more cubes that we will work with later. These cube data will all \
be plotted in the same plane.
A list like {1} or {1,3,7} will do. An array scale = {s1,s2,s3,...} can be \
used to scale the data in the different cubes, 
in case that is needed for a good combined plot. Here, by default, we just \
set all scaling factors to one.
If you want to make a plot of different cut-planes in the same combined \
graphic, the code below would need to be modified suitably.\
\>", "Text",
 CellChangeTimes->{{3.914172446085261*^9, 3.914172461813362*^9}, {
  3.914172522188727*^9, 3.9141725363156147`*^9}, {3.914241132269258*^9, 
  3.914241158750023*^9}, {3.914418830004662*^9, 3.914418839018828*^9}, {
  3.914418914703516*^9, 3.914418929451605*^9}, {3.91441901116256*^9, 
  3.914419028218847*^9}, {3.914420204698544*^9, 3.9144202114536653`*^9}, {
  3.914420272614128*^9, 3.914420284266567*^9}, {3.915362751158574*^9, 
  3.915362842378339*^9}},ExpressionUUID->"1a733974-8874-4389-ae0e-\
5d50ad9526c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pick", "=", 
    RowBox[{"{", "2", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1.", ",", " ", 
     RowBox[{"Length", "[", "pick", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.914170991065123*^9, 3.914170992606335*^9}, {
   3.914172431451913*^9, 3.914172442326302*^9}, 3.914172543632738*^9, {
   3.9141852971053*^9, 3.914185305792345*^9}, {3.9141855367914753`*^9, 
   3.914185537779334*^9}, {3.914186209336732*^9, 3.914186217005657*^9}, {
   3.914186524975808*^9, 3.914186526413625*^9}, {3.914187011971311*^9, 
   3.9141870122930403`*^9}, {3.914189124474348*^9, 3.914189124588093*^9}, {
   3.9141891608904138`*^9, 3.914189175380157*^9}, {3.914189358218112*^9, 
   3.914189389841939*^9}, {3.914241165459306*^9, 3.914241172735518*^9}, {
   3.914241479997654*^9, 3.914241484054421*^9}, {3.914242378903613*^9, 
   3.914242385003089*^9}, {3.914242436131738*^9, 3.91424243619189*^9}, {
   3.914243320937148*^9, 3.914243333595868*^9}, {3.914244241784571*^9, 
   3.914244242482314*^9}, {3.914245175616069*^9, 3.914245175960833*^9}, {
   3.9142456825114727`*^9, 3.914245683401372*^9}, {3.914248615186262*^9, 
   3.914248619769117*^9}, {3.914248701108873*^9, 3.914248704251461*^9}, {
   3.914248741245998*^9, 3.9142487442336197`*^9}, {3.91441853794597*^9, 
   3.914418560147522*^9}, {3.914418971689688*^9, 3.9144190005511427`*^9}, 
   3.914419039349093*^9, {3.914419168828843*^9, 3.914419169458785*^9}, {
   3.914419205945063*^9, 3.914419206648527*^9}, {3.914419636678521*^9, 
   3.9144196368473673`*^9}, {3.91441966887571*^9, 3.914419669393982*^9}, 
   3.914420288550414*^9, {3.915020657770932*^9, 3.9150206586425467`*^9}, {
   3.9153666101941643`*^9, 3.915366610667747*^9}, {3.915366956368499*^9, 
   3.915366956481216*^9}, {3.915369062838112*^9, 3.9153690637882023`*^9}, {
   3.915383196540963*^9, 3.9153831966315107`*^9}, {3.915383661381021*^9, 
   3.915383661476568*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"7c93945d-8de1-46ed-a1a4-c61b48e539fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Show the molecule (atom positions, too )", "Subsubsection",
 CellChangeTimes->{
  3.915035753861682*^9, {3.915035829555431*^9, 3.915035860186743*^9}, 
   3.915036148962057*^9, {3.915042120220427*^9, 3.9150421215296707`*^9}, {
   3.915362663826988*^9, 
   3.915362665363122*^9}},ExpressionUUID->"9c626022-0b9e-44c8-a361-\
6a98114ac4e3"],

Cell["\<\
Available PlotThemes are: HeavyAtom, BallAndStick, SpaceFilling, Tubes, \
Wireframe.

If you want to see an isosurface plot of the 3D data together with a molecule \
plot and numbered atoms, please run the notebook \
\[OpenCurlyDoubleQuote]orbitalplot-from-cube-interpolation.nb\
\[CloseCurlyDoubleQuote] from the folder \
\[OpenCurlyDoubleQuote]cubefile-interpolate-then-plot\[CloseCurlyDoubleQuote] \
on the selected cube.\
\>", "Text",
 CellChangeTimes->{
  3.9150429812139463`*^9, {3.915365962236721*^9, 3.915366058435883*^9}, {
   3.9153663700566883`*^9, 
   3.9153663747984867`*^9}},ExpressionUUID->"59599e13-d1cf-462b-bbe8-\
32509a143740"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mol", " ", "=", " ", 
   RowBox[{"customImporter", "[", 
    RowBox[{"flist", "[", 
     RowBox[{"[", 
      RowBox[{"pick", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"plottheme", "=", "\"\<Wireframe\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"molplot", " ", "=", " ", 
    RowBox[{"MoleculePlot3D", "[", 
     RowBox[{"mol", ",", 
      RowBox[{"PlotTheme", "->", "plottheme"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "pick", " ", "the", " ", "first", " ", "cube", " ", "in", " ", 
    "the", " ", "list", " ", "for", " ", "plotting", " ", "the", " ", 
    "molecule"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MoleculePlot3D", "[", 
  RowBox[{"mol", ",", 
   RowBox[{"AtomLabels", "->", "\"\<AtomIndex\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.915041454225462*^9, 3.915041456158354*^9}, {
  3.9150415356240063`*^9, 3.915041536698441*^9}, {3.915042798764885*^9, 
  3.915042800118904*^9}, {3.915363230970422*^9, 3.915363251190378*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"0abb2362-608b-45fe-815c-a471151abbce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"points", " ", "=", " ", 
   RowBox[{"QuantityMagnitude", " ", "@", " ", 
    RowBox[{"mol", "[", "\"\<AtomCoordinates\>\"", "]"}]}]}], ";", " ", 
  RowBox[{"TableForm", "[", 
   RowBox[{"points", ",", "  ", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "points", "]"}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "}"}]}], ",", " ", ",", " ", 
    RowBox[{"TableAlignments", "\[Rule]", "Left"}]}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.915041722499442*^9, 3.915041723039847*^9}, {
  3.915041903530758*^9, 3.915042021094922*^9}, {3.915042173334169*^9, 
  3.915042177870572*^9}, {3.915042209679873*^9, 3.915042251663*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"d5124485-bfe2-49eb-b48c-48b720893e62"],

Cell["\<\
We can append the list here, for example, to add a dummy atom position for a \
linear or planar molecule, to specify a plane later\
\>", "Text",
 CellChangeTimes->{{3.915042264491892*^9, 3.915042292589387*^9}, 
   3.915042631786625*^9, {3.9153660754592953`*^9, 
   3.9153660828382473`*^9}},ExpressionUUID->"c8055252-4875-42f7-b31f-\
d9e8aeecb6c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"points", ",", 
    RowBox[{
     RowBox[{"points", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
     RowBox[{"{", 
      RowBox[{"0.", ",", " ", "0.", ",", " ", "1."}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableForm", "[", 
   RowBox[{"points", ",", "  ", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "points", "]"}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "}"}]}], ",", " ", ",", " ", 
    RowBox[{"TableAlignments", "\[Rule]", "Left"}]}], " ", "]"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.915042697748472*^9, 3.915042735228066*^9}, 
   3.915042835955639*^9, {3.915292140344232*^9, 3.9152921457172956`*^9}, {
   3.915294007613091*^9, 3.915294022819935*^9}, {3.915294103375976*^9, 
   3.915294110353182*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0aa3a6fb-5d26-479b-aa05-222f6112b3f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Set specifications for the plots", "Subsubsection",
 CellChangeTimes->{{3.91504212966811*^9, 
  3.9150421329148417`*^9}},ExpressionUUID->"e635bf7a-668d-49ba-91ee-\
1e6894635051"],

Cell[TextData[{
 StyleBox["The If you want to plot multiple cube files together, they MUST be \
for the same system, different orbitals, otherwise expect strange (wrong) \
results  !",
  FontColor->RGBColor[1, 0, 0]],
 "\n\n",
 StyleBox["Set the main plot parameters and options in the next input cell.",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 1]],
 "\n\n",
 StyleBox["s",
  FontSlant->"Italic"],
 " = start point for the plane\n\nplane selections can be \
\[OpenCurlyDoubleQuote]xy\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]xz\
\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]yz\[CloseCurlyDoubleQuote], \
and so on, with the first letter being the horizontal direction in the \
resulting 2D view of the plot.\nNote, however, that the graphics are created \
in 3D and can be rotated prior to exporting them.\n\nAn alternative plane \
setting is  \[OpenCurlyDoubleQuote]3-points\[CloseCurlyDoubleQuote]. In thes \
case, the array \[OpenCurlyDoubleQuote]vertices\[CloseCurlyDoubleQuote] must \
also be given, with atom numbers corresponding to the content of array \
\[OpenCurlyDoubleQuote]points\[CloseCurlyDoubleQuote] listed above. The atom \
numbers are shown in the molecule plot earlier, in case you need to know what \
atoms should be used to define the plane for \[OpenCurlyDoubleQuote]3-points\
\[CloseCurlyDoubleQuote]. With \[OpenCurlyDoubleQuote]3-atoms\
\[CloseCurlyDoubleQuote], the first atom selected in array vertices will \
define the point ",
 StyleBox["s",
  FontSlant->"Italic"],
 " on the plane.\n\n",
 StyleBox["r",
  FontSlant->"Italic"],
 " and ",
 StyleBox["j",
  FontSlant->"Italic"],
 ": the value ",
 StyleBox["r",
  FontSlant->"Italic"],
 " for the lowest contour and the number ",
 StyleBox["j",
  FontSlant->"Italic"],
 " of contours.\nWe use increments by factors of 2, but that can also be \
customized (",
 StyleBox["base",
  FontSlant->"Italic"],
 " value)\n\nopacity value for the plot plane: You can set it nonzero (0.05, \
for example) to see the plane.\nThe resulting graphs can be rotated because \
they are 3D, if that works better for export. The default setting\nis a \
viewpoint along the plot plane normal"
}], "Text",
 CellChangeTimes->{{3.914172555193645*^9, 3.914172589880731*^9}, {
   3.91424205797431*^9, 3.9142421016015387`*^9}, {3.914243000102604*^9, 
   3.914243000618596*^9}, {3.914243037452736*^9, 3.914243039900666*^9}, 
   3.914418707227929*^9, {3.914419048977206*^9, 3.914419070221856*^9}, {
   3.914420393018765*^9, 3.9144204440650377`*^9}, {3.914773310467698*^9, 
   3.914773318862602*^9}, {3.915027332014656*^9, 3.915027358947116*^9}, {
   3.9150275619823437`*^9, 3.91502757380987*^9}, {3.915027848149273*^9, 
   3.915027863454949*^9}, {3.915041060938849*^9, 3.915041082472279*^9}, {
   3.915042870678677*^9, 3.9150429717916927`*^9}, {3.915303371613111*^9, 
   3.915303493582808*^9}, {3.915366112485409*^9, 3.915366119305285*^9}, {
   3.915366157267502*^9, 3.915366175318657*^9}, {3.915534393121126*^9, 
   3.91553445187919*^9}},ExpressionUUID->"4e4e8640-33d1-4448-8d54-\
e01fb24bb6cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "=", "0.03"}], ",", 
      RowBox[{"j", "=", "6"}], ",", " ", 
      RowBox[{"base", " ", "=", " ", "2"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"contours", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "  ", 
          RowBox[{"base", "^", "n"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "r"}], " ", 
          RowBox[{"2", "^", "n"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", "j"}], "}"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"opacity", "=", "0"}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"plane", " ", "origin", " ", "for", " ", "xy"}], ",", " ", "xz", 
    ",", " ", 
    RowBox[{"...", " ", "option"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plane", " ", "=", " ", "\"\<3-points\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vertices", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6", ",", "7"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.914241295923602*^9, {3.914241596962008*^9, 3.914241625576193*^9}, {
   3.914241867985268*^9, 3.914241885772975*^9}, {3.914242122446246*^9, 
   3.914242123635881*^9}, 3.914418613958151*^9, {3.914419083150938*^9, 
   3.9144190898049726`*^9}, 3.915020670610561*^9, {3.915020898252022*^9, 
   3.915020899053855*^9}, {3.915024916608809*^9, 3.915024923882312*^9}, {
   3.915025106785612*^9, 3.915025113161029*^9}, {3.915027279549786*^9, 
   3.915027291032295*^9}, {3.915027366090732*^9, 3.9150273944719276`*^9}, {
   3.9150274705933*^9, 3.915027471195737*^9}, {3.915027548632556*^9, 
   3.915027553873263*^9}, {3.91502795362831*^9, 3.9150279542242327`*^9}, {
   3.9150355410545607`*^9, 3.915035559305345*^9}, {3.915036297146056*^9, 
   3.915036350070981*^9}, {3.915042775934312*^9, 3.915042777708313*^9}, {
   3.915042851943712*^9, 3.915042852543467*^9}, {3.915042994771986*^9, 
   3.915043043834421*^9}, {3.915282270614493*^9, 3.915282272800004*^9}, {
   3.915289999339601*^9, 3.915290020126258*^9}, {3.9152909725394487`*^9, 
   3.915290977492269*^9}, 3.915292022289921*^9, {3.9152922758329697`*^9, 
   3.9152922830310373`*^9}, {3.915292612265418*^9, 3.915292612746057*^9}, {
   3.915297246575378*^9, 3.915297247178918*^9}, {3.915297789679446*^9, 
   3.9152977897501287`*^9}, {3.9152978697008333`*^9, 3.91529787039277*^9}, {
   3.9152985837048492`*^9, 3.915298599996543*^9}, {3.9153669777879543`*^9, 
   3.915366980387546*^9}, {3.9153670447522583`*^9, 3.9153670457848063`*^9}, {
   3.915367090247465*^9, 3.9153670907020397`*^9}, {3.9153677136334467`*^9, 
   3.915367718399036*^9}, {3.915368787279161*^9, 3.915368790882012*^9}, {
   3.915369072130516*^9, 3.9153690750311737`*^9}, {3.915369391343936*^9, 
   3.9153693943377*^9}, {3.915369608567012*^9, 3.915369608753796*^9}, {
   3.9153699960357313`*^9, 3.9153699978393373`*^9}, {3.9153700692513943`*^9, 
   3.9153700832601767`*^9}, {3.915370179871509*^9, 3.915370184493146*^9}, {
   3.9153713886934967`*^9, 3.915371389675909*^9}, {3.915371475873643*^9, 
   3.9153714763283978`*^9}, {3.915379391857399*^9, 3.915379392846087*^9}, {
   3.9153798044422483`*^9, 3.915379805051922*^9}, {3.915379835768285*^9, 
   3.915379836425167*^9}, {3.915383182606865*^9, 3.915383187442541*^9}, {
   3.915383238782144*^9, 3.915383239439054*^9}, {3.915383287685401*^9, 
   3.915383290270053*^9}, {3.915383667564872*^9, 3.91538367340162*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"b27ef285-598a-4623-a18a-d795fbaa85fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Code to generate the plots (no need to open this, click the button in the \
next section)\
\>", "Subsubsection",
 CellChangeTimes->{{3.914420186630795*^9, 3.914420189273237*^9}, {
  3.914774193935643*^9, 3.914774197692464*^9}, {3.914774291571957*^9, 
  3.91477429991182*^9}, {3.914775838068705*^9, 3.914775847489383*^9}, {
  3.9147763429013586`*^9, 
  3.914776347524042*^9}},ExpressionUUID->"b226dcc2-666f-4203-ac2a-\
2c8e7321c55a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plane", "==", "\"\<xy\>\""}], ",", " ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"{", 
           RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], ";", " ", 
         RowBox[{"v2", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], ";"}]}], "  ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plane", "==", "\"\<xz\>\""}], ",", " ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"{", 
           RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], ";", " ", 
         RowBox[{"v2", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], ";"}]}], "  ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plane", "==", "\"\<yz\>\""}], ",", " ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], ";", " ", 
         RowBox[{"v2", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], ";"}]}], "  ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plane", "==", "\"\<yx\>\""}], ",", " ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], ";", " ", 
         RowBox[{"v2", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], ";"}]}], "  ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plane", "==", "\"\<zx\>\""}], ",", " ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], ";", " ", 
         RowBox[{"v2", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], ";"}]}], "  ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plane", "==", "\"\<zy\>\""}], ",", " ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], ";", " ", 
         RowBox[{"v2", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], ";"}]}], "  ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plane", "==", " ", "\"\<3-points\>\""}], ",", " ", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n1", ",", " ", "n2", ",", " ", "vecs"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n1", " ", "=", " ", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", 
             RowBox[{"vertices", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "  ", "-", " ", 
           RowBox[{"points", "[", 
            RowBox[{"[", 
             RowBox[{"vertices", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], " ", ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n2", " ", "=", " ", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", 
             RowBox[{"vertices", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "  ", "-", " ", 
           RowBox[{"points", "[", 
            RowBox[{"[", 
             RowBox[{"vertices", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"vecs", " ", "=", " ", 
          RowBox[{"Orthogonalize", "[", 
           RowBox[{"{", 
            RowBox[{"n1", ",", " ", "n2"}], "}"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"vecs", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"n1", ",", " ", "n2"}], "}"}]}], ";"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"v1", " ", "=", " ", 
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
         
         RowBox[{"v2", " ", "=", " ", 
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<n1, n2, vecs: \>\"", ",", "n1", ",", " ", "\"\<, \>\"", ",", 
             " ", "n2", ",", " ", "\"\<, \>\"", ",", " ", "vecs"}], "]"}], 
           ";"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"s", " ", "=", " ", 
          RowBox[{"points", "[", 
           RowBox[{"[", 
            RowBox[{"vertices", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "vertices", "]"}], " ", "\[NotEqual]", " ",
             "3"}], ",", " ", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<ERROR: vertices array must have 3 values\>\"", "]"}], ";",
               " ", 
              RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], " ", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vertices", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "<", " ", "1"}], "  ", "||",
               " ", 
              RowBox[{
               RowBox[{"vertices", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", ">", " ", 
               RowBox[{"Length", "[", "points", "]"}]}]}], ",", " ", 
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<ERROR: one or more vertices entries out of range\>\"", 
                 "]"}], ";", " ", 
                RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], " ", "]"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", ",", 
      " ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<ERROR in plane selection\>\"", "]"}], ";",
          " ", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"v3", " ", "=", " ", 
     RowBox[{"Cross", "[", 
      RowBox[{"v1", ",", " ", "v2"}], "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"plane", " ", "normal"}], ",", "  ", 
      RowBox[{
      "will", " ", "also", " ", "be", " ", "the", " ", "default", " ", "view",
        " ", "direction"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"view", " ", "=", " ", 
     RowBox[{"2", " ", "v3"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vert", " ", "=", " ", "v2"}], ";", "\n", "\n", 
    RowBox[{"SetSharedVariable", "[", "field", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"field", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cube", ",", " ", "vol", ",", " ", "volRange", ",", "data", ",", "n", 
        ",", " ", "min", ",", " ", "max", ",", " ", "min1", ",", " ", "max1", 
        ",", " ", "min2", ",", " ", "max2", ",", " ", "step", ",", " ", "f", 
        ",", "  ", "plotSlice", ",", " ", "a", ",", " ", "b"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParallelDo", "[", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"cube", "=", 
           RowBox[{"flist", "[", 
            RowBox[{"[", 
             RowBox[{"pick", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "]"}], "]"}]}], ";", 
          RowBox[{"(*", " ", 
           RowBox[{
           "pick", " ", "a", " ", "cube", " ", "in", " ", "the", " ", "list", 
            " ", "for", " ", "plotting", " ", "the", " ", "molecule"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"vol", " ", "=", " ", 
           RowBox[{"Import", "[", 
            RowBox[{"cube", ",", "\"\<VolumetricData\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"volRange", " ", "=", " ", 
           RowBox[{"vol", "[", "\"\<DataRange\>\"", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"data", " ", "=", " ", 
           RowBox[{"Normal", "[", 
            RowBox[{"vol", "[", 
             RowBox[{"[", 
              RowBox[{"\"\<Data\>\"", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{"Dimensions", "[", "data", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"min", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"volRange", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"max", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"volRange", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"step", " ", "=", " ", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"max", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"min", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "-", "1"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"max", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"min", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"max", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "-", 
                RowBox[{"min", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<min and max :\>\"", ",", " ", "min", ",", " ", "\"\<,  \>\"", 
            ",", " ", "max"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<vector basis for plot: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", " ", "v2", ",", " ", "v3"}], "}"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<min, max in plot vector basis: \>\"", ",", 
            RowBox[{"min", ".", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], "]"}]}], ",", 
            "\"\<,  \>\"", ",", " ", 
            RowBox[{"max", ".", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], "]"}]}]}], "]"}], 
          ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "Now", " ", "we", " ", "make", " ", "an", " ", "interpolation", 
             " ", "function", " ", "from", " ", "the", " ", "3", "D", " ", 
             "volume", " ", "data"}], ",", " ", 
            RowBox[{
            "so", " ", "we", " ", "can", " ", "plot", " ", "slices", " ", 
             "easier", "\n", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"note", " ", "the", " ", "use", " ", "of", " ", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"z", ",", "y", ",", "x"}], "]"}], "]"}], " ", 
                "below"}], ",", " ", 
               RowBox[{"and", " ", "the", " ", "gymnastics", " ", "with", " ", 
                RowBox[{"n", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "in", " ", "the", " ", 
                "\"\<step\>\"", " ", "array", " ", "above"}], ",", 
               RowBox[{
                RowBox[{
                "which", " ", "is", " ", "because", " ", "the", " ", "z"}], 
                "-", 
                RowBox[{
                "loop", " ", "runs", " ", "fastest", " ", "in", " ", "the", 
                 " ", "cube", " ", "spec", " ", "Fortran", " ", "code"}]}]}], 
              ")"}]}]}], " ", "*)"}], "\n", "\n", 
          RowBox[{"Clear", "[", "f", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"f", " ", "=", " ", 
           RowBox[{"Interpolation", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"min", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "1"}], ")"}], " ", 
                    RowBox[{"step", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"min", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "1"}], ")"}], " ", 
                    RowBox[{"step", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"min", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z", "-", "1"}], ")"}], " ", 
                    RowBox[{"step", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"scale", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", 
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"z", ",", "y", ",", "x"}], "]"}], "]"}]}]}], 
                 "\[IndentingNewLine]", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "1", ",", 
                  RowBox[{"n", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "1", ",", 
                  RowBox[{"n", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "1", ",", 
                  RowBox[{"n", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
              "2"}], "]"}], "]"}]}], ";", "\n", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "Now", " ", "we", " ", "plot", " ", "a", " ", "slice", " ", "in", 
             " ", "3", "D", " ", "to", " ", "add", " ", "it", " ", "to", " ", 
             "the", " ", "plot", " ", "of", " ", "the", " ", 
             RowBox[{"molecule", ".", " ", "The"}], " ", "cut", " ", "plane", 
             " ", "is", " ", "defined", " ", "parametrically", " ", "via", 
             " ", "a", " ", "startpoint", " ", "and", " ", "two", " ", 
             "vectors"}], ",", " ", 
            RowBox[{
            "somewhat", " ", "like", " ", "the", " ", "grid", " ", "in", " ", 
             "the", " ", "cube", " ", 
             RowBox[{"file", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Determine", " ", "data", " ", "range", " ", "in", " ", "the", " ",
             "cube", " ", "corresponding", " ", "to", " ", "our", " ", 
            "slice"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"sol", ",", "t"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Off", "[", 
              StyleBox[
               RowBox[{"Reduce", "::", "ratnz"}], "MessageName"], " ", "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"min1", " ", "=", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"min", "+", 
                   RowBox[{"0", " ", "s"}]}], ")"}], ".", "v1"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"min2", " ", "=", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"min", "+", 
                   RowBox[{"0", " ", "s"}]}], ")"}], ".", "v2"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"max1", " ", "=", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"max", "+", 
                   RowBox[{"0", " ", "s"}]}], ")"}], ".", "v1"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"max2", " ", "=", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"max", "+", 
                   RowBox[{"0", " ", "s"}]}], ")"}], ".", "v2"}]}], ";"}], 
              " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"sol", " ", "=", " ", 
              RowBox[{"Reduce", "[", 
               RowBox[{
                RowBox[{"{", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"min", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<=", " ", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "<=", " ", 
                   RowBox[{"max", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"min", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<=", " ", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "<=", " ", 
                   RowBox[{"max", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"min", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "<=", " ", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}]}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], " ", "<=", " ", 
                   RowBox[{"max", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", " ", "t", 
                ",", " ", "Reals"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"min1", " ", "=", " ", 
              RowBox[{"sol", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"max1", " ", "=", " ", 
              RowBox[{"sol", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"sol", " ", "=", " ", 
              RowBox[{"Reduce", "[", 
               RowBox[{
                RowBox[{"{", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"min", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<=", " ", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "<=", " ", 
                   RowBox[{"max", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"min", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<=", " ", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "<=", " ", 
                   RowBox[{"max", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"min", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "<=", " ", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}]}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], " ", "<=", " ", 
                   RowBox[{"max", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", " ", "t", 
                ",", " ", "Reals"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"min2", " ", "=", " ", 
              RowBox[{"sol", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"max2", " ", "=", " ", 
              RowBox[{"sol", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<plot limits: \>\"", ",", " ", "min1", ",", "\"\<, \>\"", 
               ",", " ", "max1", ",", "\"\<, \>\"", ",", " ", "min2", ",", 
               "\"\<, \>\"", ",", " ", "max2"}], "]"}], ";"}]}], "  ", 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "\n", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "-", "1"}], ",", "2"}], "]"}], "==", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Use", " ", "the", " ", "first", " ", "two", " ", "colors", " ", 
              
              RowBox[{"(", 
               RowBox[{
                RowBox[{"red", "/", "blue"}], " ", "by", " ", "default"}], 
               ")"}], " ", "for", " ", "even", " ", "numbered", " ", 
              RowBox[{"pick", "[", "]"}], " ", "values"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"plotSlice", " ", "=", " ", 
             RowBox[{"ParametricPlot3D", "[", 
              RowBox[{
               RowBox[{"s", " ", "+", " ", 
                RowBox[{"u", " ", "v1"}], " ", "+", " ", 
                RowBox[{"v", " ", "v2"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"u", ",", "min1", ",", " ", "max1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"v", ",", "min2", ",", " ", "max2"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"FaceForm", "[", 
                 RowBox[{
                  RowBox[{"Directive", "[", 
                   RowBox[{"Gray", ",", 
                    RowBox[{"Opacity", "[", "opacity", "]"}]}], "]"}], ",", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Gray", ",", 
                    RowBox[{"Opacity", "[", "opacity", "]"}]}], "]"}]}], 
                 "]"}]}], ",", 
               RowBox[{"PlotPoints", "\[Rule]", "60"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Lighting", "->", "None"}], ",", 
               RowBox[{"Ticks", "\[Rule]", "False"}], ",", " ", 
               RowBox[{"MaxRecursion", "->", "6"}], ",", 
               RowBox[{"Background", "->", "None"}], ",", 
               "\[IndentingNewLine]", " ", 
               RowBox[{"MeshFunctions", "->", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"f", "[", 
                    RowBox[{"#1", ",", "#2", ",", " ", "#3"}], "]"}], "&"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"f", "[", 
                    RowBox[{"#1", ",", "#2", ",", " ", "#3"}], "]"}], "&"}]}],
                  "\[IndentingNewLine]", "}"}]}], ",", 
               RowBox[{"MeshStyle", "\[Rule]", " ", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"colors", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.003", "]"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"colors", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.003", "]"}]}], "}"}]}], 
                 "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Mesh", "\[Rule]", "contours"}], ",", 
               RowBox[{"BoundaryStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Opacity", "[", "0", "]"}], "]"}]}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Use", " ", "the", " ", "second", " ", "two", " ", "colors", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"green", "/", "dark"}], " ", "orange", " ", "by", " ",
                 "default"}], ")"}], " ", "for", " ", "odd", " ", "numbered", 
              " ", 
              RowBox[{"pick", "[", "]"}], " ", "values"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"plotSlice", " ", "=", " ", 
             RowBox[{"ParametricPlot3D", "[", 
              RowBox[{
               RowBox[{"s", " ", "+", " ", 
                RowBox[{"u", " ", "v1"}], " ", "+", " ", 
                RowBox[{"v", " ", "v2"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"u", ",", "min1", ",", " ", "max1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"v", ",", "min2", ",", " ", "max2"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"FaceForm", "[", 
                 RowBox[{
                  RowBox[{"Directive", "[", 
                   RowBox[{"Gray", ",", 
                    RowBox[{"Opacity", "[", "opacity", "]"}]}], "]"}], ",", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Gray", ",", 
                    RowBox[{"Opacity", "[", "opacity", "]"}]}], "]"}]}], 
                 "]"}]}], ",", 
               RowBox[{"PlotPoints", "\[Rule]", "60"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Lighting", "->", "None"}], ",", 
               RowBox[{"Ticks", "\[Rule]", "False"}], ",", " ", 
               RowBox[{"MaxRecursion", "->", "6"}], ",", 
               RowBox[{"Background", "->", "None"}], ",", 
               "\[IndentingNewLine]", " ", 
               RowBox[{"MeshFunctions", "->", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"f", "[", 
                    RowBox[{"#1", ",", "#2", ",", " ", "#3"}], "]"}], "&"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"f", "[", 
                    RowBox[{"#1", ",", "#2", ",", " ", "#3"}], "]"}], "&"}]}],
                  "\[IndentingNewLine]", "}"}]}], ",", 
               RowBox[{"MeshStyle", "\[Rule]", " ", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"colors", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.003", "]"}], ",", " ", 
                    RowBox[{"Dashing", "[", 
                    RowBox[{"{", " ", 
                    RowBox[{"0.02", ",", " ", "0.01"}], "}"}], "]"}]}], "}"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"colors", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.003", "]"}], ",", " ", 
                    RowBox[{"Dashing", "[", 
                    RowBox[{"{", " ", 
                    RowBox[{"0.02", ",", " ", "0.01"}], "}"}], "]"}]}], 
                   "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Mesh", "\[Rule]", "contours"}], ",", 
               RowBox[{"BoundaryStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Opacity", "[", "0", "]"}], "]"}]}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{"Combine", " ", "the", " ", 
            RowBox[{"plots", "."}]}], "  ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"field", ",", 
            RowBox[{"Show", "[", 
             RowBox[{"plotSlice", ",", 
              RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"Ticks", "\[Rule]", "False"}], ",", 
              RowBox[{"ViewPoint", "\[Rule]", "view"}], ",", " ", 
              RowBox[{"ViewVertical", " ", "->", " ", "vert"}], ",", "  ", 
              RowBox[{"ImageSize", "->", "400"}]}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", " ", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", 
           RowBox[{"Length", "[", "pick", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<... done with creating contours. You can now evaluate the next \
cell to show the results if there are no errors. With plane set to 3-points, \
you might get some warnings about Extrapolation being used. This is perhaps \
harmless.\>\"", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", ")"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.793787936129014*^9, 3.793787955586397*^9}, 
   3.793788244943744*^9, {3.793788279455273*^9, 3.793788281379185*^9}, {
   3.793797231399516*^9, 3.793797248189386*^9}, {3.793797359673271*^9, 
   3.793797372207142*^9}, {3.7937974347534847`*^9, 3.7937974409241133`*^9}, {
   3.793798894276332*^9, 3.7937990136937447`*^9}, {3.793799210256448*^9, 
   3.793799232274712*^9}, {3.793800290795893*^9, 3.793800294939698*^9}, 
   3.793809625961751*^9, {3.793811454231839*^9, 3.793811542477461*^9}, {
   3.793811583516202*^9, 3.793811589204122*^9}, {3.793812480725964*^9, 
   3.793812482677903*^9}, {3.793822941215563*^9, 3.793822941651073*^9}, {
   3.853862411299104*^9, 3.85386243042754*^9}, {3.853925763218968*^9, 
   3.853925766173764*^9}, {3.853925810939453*^9, 3.8539258111215878`*^9}, {
   3.853931504821154*^9, 3.853931504971962*^9}, {3.8647220062718167`*^9, 
   3.864722007032493*^9}, {3.8648087328805237`*^9, 3.864808761078828*^9}, {
   3.864808809941865*^9, 3.864808815585608*^9}, {3.864809172740831*^9, 
   3.864809173118518*^9}, {3.864809410555665*^9, 3.864809411264662*^9}, {
   3.86480968171535*^9, 3.864809693250341*^9}, {3.86481049641626*^9, 
   3.864810496450425*^9}, {3.864810583408517*^9, 3.864810583489043*^9}, {
   3.8648107995038548`*^9, 3.864810799564011*^9}, {3.864811471296981*^9, 
   3.864811472114854*^9}, {3.864826964426809*^9, 3.864826964769217*^9}, {
   3.8977265642338753`*^9, 3.897726568514516*^9}, {3.897728618908751*^9, 
   3.897728627364645*^9}, {3.897728757427329*^9, 3.897728765781805*^9}, {
   3.914071090584407*^9, 3.914071092490871*^9}, {3.9140777465271606`*^9, 
   3.914077746950813*^9}, {3.914162468783587*^9, 3.9141624688693457`*^9}, {
   3.914164286256906*^9, 3.914164286891412*^9}, {3.914164808991652*^9, 
   3.9141648100864577`*^9}, {3.914172626303006*^9, 3.914172712911684*^9}, {
   3.9141727712627587`*^9, 3.914172781494815*^9}, {3.914174477697906*^9, 
   3.914174478189829*^9}, {3.9141747663906736`*^9, 3.9141747777003117`*^9}, {
   3.914174864366918*^9, 3.914174959988058*^9}, {3.914185320275083*^9, 
   3.914185335645569*^9}, 3.914185403235224*^9, {3.914185813488426*^9, 
   3.914185926643965*^9}, {3.9141859742354107`*^9, 3.914186013387237*^9}, 
   3.914186309986964*^9, {3.9141863603228807`*^9, 3.9141864054684763`*^9}, {
   3.91418643835917*^9, 3.914186446766232*^9}, {3.914186529017734*^9, 
   3.91418656268108*^9}, {3.914186634367724*^9, 3.91418674304177*^9}, {
   3.914186776679329*^9, 3.914186815221946*^9}, {3.914186900916335*^9, 
   3.914186903978241*^9}, {3.9141869488524437`*^9, 3.914186994832337*^9}, {
   3.914188066345008*^9, 3.914188070538456*^9}, {3.914188121499324*^9, 
   3.914188149597844*^9}, {3.914188351275371*^9, 3.9141883517434607`*^9}, {
   3.9141884159384727`*^9, 3.914188417752088*^9}, {3.914188847828933*^9, 
   3.914188920543178*^9}, {3.914189020366275*^9, 3.914189032231335*^9}, {
   3.9141894755876217`*^9, 3.914189476798005*^9}, {3.914189623556363*^9, 
   3.914189624761038*^9}, {3.914189818557254*^9, 3.91418982846539*^9}, {
   3.91419010187681*^9, 3.9141901229348593`*^9}, {3.914240890743246*^9, 
   3.914240897875329*^9}, {3.914240957172438*^9, 3.9142409865126123`*^9}, {
   3.9142410705951347`*^9, 3.914241101480776*^9}, 3.9142412338335743`*^9, {
   3.914241586496808*^9, 3.914241700361767*^9}, {3.914241762369725*^9, 
   3.914241832181808*^9}, {3.914241895657686*^9, 3.91424190790658*^9}, {
   3.914242143065642*^9, 3.914242164362455*^9}, {3.914242206032741*^9, 
   3.914242304488638*^9}, {3.914242391724386*^9, 3.914242407599369*^9}, {
   3.914242452195548*^9, 3.9142424570306*^9}, {3.9142428387826757`*^9, 
   3.914242869433759*^9}, {3.9142429291717973`*^9, 3.914242930400611*^9}, {
   3.914243642560371*^9, 3.914243653644383*^9}, {3.914419443158938*^9, 
   3.914419466817256*^9}, {3.914419572806915*^9, 3.914419581763941*^9}, {
   3.914420051076097*^9, 3.914420098928849*^9}, {3.914420142450053*^9, 
   3.914420155355466*^9}, {3.914772560030212*^9, 3.914772650658999*^9}, {
   3.9150208448565283`*^9, 3.9150208913854523`*^9}, {3.915021360433525*^9, 
   3.9150214069798107`*^9}, 3.915021438054056*^9, {3.915024641413219*^9, 
   3.9150246594788523`*^9}, {3.915024877044697*^9, 3.91502489600065*^9}, {
   3.915025064417856*^9, 3.9150250654447927`*^9}, 3.9150276140330553`*^9, {
   3.915027653924224*^9, 3.9150277679663067`*^9}, {3.915027798388928*^9, 
   3.91502782104603*^9}, {3.915028172970783*^9, 3.915028177453154*^9}, {
   3.91502820757296*^9, 3.915028209849493*^9}, {3.9150286842478123`*^9, 
   3.915028699722267*^9}, {3.9150287484359713`*^9, 3.9150288375146837`*^9}, {
   3.915035710786497*^9, 3.91503577057535*^9}, {3.915036254466956*^9, 
   3.915036268993222*^9}, {3.91504306006068*^9, 3.91504319059792*^9}, {
   3.915043469166698*^9, 3.915043474037402*^9}, {3.915043528561636*^9, 
   3.915043587111868*^9}, {3.9150451484407187`*^9, 3.915045152249617*^9}, {
   3.915093199498542*^9, 3.91509320115985*^9}, 3.915282782857814*^9, {
   3.915282835040751*^9, 3.915282848889865*^9}, 3.915282988187518*^9, {
   3.915283105057571*^9, 3.915283124335822*^9}, {3.915283338214898*^9, 
   3.9152833769086514`*^9}, 3.9152835174642973`*^9, 3.91528357271682*^9, {
   3.915283623148677*^9, 3.9152836256415358`*^9}, {3.915283704401581*^9, 
   3.915283717670445*^9}, {3.915284874795827*^9, 3.915284885154233*^9}, {
   3.915288031556447*^9, 3.9152880659641953`*^9}, {3.915288096970759*^9, 
   3.915288118184758*^9}, {3.915288233708865*^9, 3.9152882773107347`*^9}, {
   3.915288381409382*^9, 3.9152884857148657`*^9}, {3.9152887025245867`*^9, 
   3.915288754550565*^9}, {3.91528894519648*^9, 3.915288969407414*^9}, {
   3.9152898217293997`*^9, 3.915289900085268*^9}, {3.915289949779977*^9, 
   3.9152899538926773`*^9}, {3.915290081362068*^9, 3.91529009378784*^9}, {
   3.915290783599557*^9, 3.9152909409144697`*^9}, 3.915291195078335*^9, {
   3.915291236045583*^9, 3.915291259777197*^9}, {3.915291308935597*^9, 
   3.915291318526898*^9}, {3.9152914518210287`*^9, 3.9152914726865807`*^9}, {
   3.9152915740650053`*^9, 3.915291580590239*^9}, {3.9152919516300583`*^9, 
   3.915291951739912*^9}, {3.915292618155095*^9, 3.915292643631661*^9}, {
   3.9152927906122913`*^9, 3.9152928005259666`*^9}, {3.9152928372770042`*^9, 
   3.915292844868662*^9}, {3.91529290272114*^9, 3.91529291339478*^9}, {
   3.9152934628239403`*^9, 3.915293489098131*^9}, {3.915293876393415*^9, 
   3.915293886662567*^9}, {3.915294236907674*^9, 3.91529424263561*^9}, {
   3.9152944006265793`*^9, 3.915294402329117*^9}, {3.915294445527192*^9, 
   3.915294465698763*^9}, {3.915294599903234*^9, 3.9152946068169003`*^9}, {
   3.915294815035718*^9, 3.915294824024768*^9}, {3.915294861553637*^9, 
   3.915294870449786*^9}, {3.9152951624713717`*^9, 3.915295196498453*^9}, {
   3.915295249276204*^9, 3.915295270942437*^9}, {3.915295307022731*^9, 
   3.915295310077055*^9}, {3.915295369808148*^9, 3.915295376474937*^9}, {
   3.9152956416639757`*^9, 3.915295655151771*^9}, {3.9152968616173077`*^9, 
   3.915296865327284*^9}, {3.9152968986415777`*^9, 3.9152969001503*^9}, {
   3.915296973187355*^9, 3.915296974544855*^9}, {3.915297178561157*^9, 
   3.915297184397003*^9}, {3.9152974002430487`*^9, 3.915297404105103*^9}, {
   3.915366936206109*^9, 3.9153669438171167`*^9}, {3.915368474670342*^9, 
   3.915368503310589*^9}, {3.91536860677288*^9, 3.915368655177916*^9}, {
   3.9153688856621323`*^9, 3.915368921895014*^9}, {3.91536901681994*^9, 
   3.915369026323443*^9}, {3.9153690910878363`*^9, 3.915369123040506*^9}, {
   3.915369164040691*^9, 3.915369340026894*^9}, {3.915369510770157*^9, 
   3.9153695940378637`*^9}, {3.9153696494316473`*^9, 3.91536966168717*^9}, {
   3.915369970222269*^9, 3.915369982185473*^9}, 3.915370055607396*^9, {
   3.915370264165188*^9, 3.9153703025385017`*^9}, {3.915370377822809*^9, 
   3.91537038022265*^9}, {3.915379642521049*^9, 3.91537976790082*^9}, {
   3.9153798298733377`*^9, 3.91537982998507*^9}, {3.915379888418569*^9, 
   3.915379893754575*^9}, {3.915379944719606*^9, 3.9153799461264544`*^9}, {
   3.915379980684816*^9, 3.915380130513917*^9}, {3.915380228812847*^9, 
   3.915380242447548*^9}, {3.915380793573279*^9, 3.915380797780851*^9}, {
   3.9153809128077602`*^9, 3.915380915674172*^9}, {3.915382141518277*^9, 
   3.91538214729876*^9}, {3.9153824009453583`*^9, 3.9153824991971483`*^9}, {
   3.9153826604640827`*^9, 3.915382665332999*^9}, {3.915382750594797*^9, 
   3.915382752487844*^9}, {3.915383081996888*^9, 3.9153830987469788`*^9}},
 CellTags->"make-contours",
 CellLabel->"In[1]:=",ExpressionUUID->"3253bf76-164a-490e-a0d4-bcaab2ab13d2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate and view combined plots", "Subsubsection",
 CellChangeTimes->{{3.91442047680878*^9, 3.91442048494007*^9}, {
  3.914774097653467*^9, 
  3.9147741029742193`*^9}},ExpressionUUID->"fd91ba99-4141-41a5-8a4c-\
9a02c7c502ae"],

Cell[BoxData[
 ButtonBox["\<\"Create contours (may take a while...) \"\>",
  Appearance->Automatic,
  ButtonFunction:>NotebookEvaluate[
    EvaluationNotebook[], EvaluationElements -> {"Tags" -> {"make-contours"}}],
  Evaluator->Automatic,
  Method->"Queued"]], "Output",
 CellChangeTimes->{3.914776168181922*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"db76cb3e-4de3-4ab2-873e-ee787b0c7771"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vp", " ", "=", " ", "view"}], ";", " ", 
  RowBox[{"vv", " ", "=", " ", "vert"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"combined", " ", "=", " ", 
  RowBox[{"Show", "[", 
   RowBox[{"molplot", ",", 
    RowBox[{"field", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
    RowBox[{"ViewPoint", "\[Rule]", 
     RowBox[{"Dynamic", "[", "vp", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ViewVertical", "\[Rule]", 
     RowBox[{"Dynamic", "[", "vv", "]"}]}], " ", ",", 
    RowBox[{"ImageSize", "->", "400"}], ",", " ", 
    RowBox[{"Background", "->", "None"}], ",", " ", 
    RowBox[{"Lighting", "->", "\"\<Neutral\>\""}]}], " ", "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQ7d+kdni75lvH0p0KR0C02aLTt0B0b+XkhyD63FEj
8R1A+vGfXDB9Y7WzOohOXuGrCaI/JDEb7gTSSjuzwPSPuNAKEJ3NMBFM+zwp
XAWi1y72WQuiI8w2P70EpJOuKj4H0Yu4H6y7DKQdJklvBNEHIv/xXAHSR5/y
8oLoazZ59iDay6kJTMfdWu4KogNtmNxBdPVulkIQPU+7HEynb522SFPrraOO
21kwvXZ5F/M1IG2x+guYXnTRRwRE74npAdP/lU8vuw6kAzm8l4PouBLXKyC6
SyAZTAs+1tEP1H7r+IzZCkxP15oWegVIX7M8AaaX9Z5X/wGkP159AaYfOXJ8
/gekf11QANP37x9T+g+kv8pbqYDoPFsOFgadt44i5eJgGgBOPr+K
  "],
 CellLabel->"In[2]:=",ExpressionUUID->"9ac83f03-5ba4-4c63-9948-ab4f1efd4b57"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export the plot as PNG (transparent background)", "Subsubsection",
 CellChangeTimes->{{3.914420683980445*^9, 
  3.914420694890698*^9}},ExpressionUUID->"338c4151-30dc-4fc9-a058-\
d49712d9d719"],

Cell["Use the following Export command to save the plot:", "Text",
 CellChangeTimes->{{3.914165764071076*^9, 3.914165771702026*^9}, 
   3.914185844576467*^9, {3.914245103566285*^9, 3.9142451618345127`*^9}, {
   3.9142457959897404`*^9, 3.9142458088477097`*^9}, {3.914419697713282*^9, 
   3.914419726590015*^9}, {3.914772994407564*^9, 3.914772994925446*^9}, {
   3.915366772569504*^9, 
   3.915366776091311*^9}},ExpressionUUID->"169bb6c1-81c3-4fb9-874c-\
462926e4a6c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fname", " ", "=", " ", "\"\<contours\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"fname", " ", "=", " ", 
     RowBox[{"fname", "<>", "\"\<-\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"pick", "[", 
        RowBox[{"[", "m", "]"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", "1", ",", 
      RowBox[{"Length", "[", "pick", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", " ", "=", " ", 
   RowBox[{"fname", "<>", "\"\<.png\>\""}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"fname", ",", "combined", ",", 
    RowBox[{"ImageResolution", "->", "400"}], ",", " ", 
    RowBox[{"Background", "->", "None"}], ",", " ", 
    RowBox[{"PlotRangePadding", "->", "None"}], ",", " ", 
    RowBox[{"ImagePadding", "->", "None"}]}], "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.914164210082346*^9, 3.914164213960557*^9}, {
   3.914165490031578*^9, 3.914165495337368*^9}, {3.9141656659041023`*^9, 
   3.914165685997884*^9}, {3.914190147565949*^9, 3.914190177542667*^9}, {
   3.914242540085004*^9, 3.914242542539768*^9}, {3.914242668765321*^9, 
   3.914242668862142*^9}, {3.9142427018397627`*^9, 3.91424272498844*^9}, {
   3.914242757367137*^9, 3.914242817782887*^9}, {3.914243072241022*^9, 
   3.914243267348186*^9}, {3.914244296798274*^9, 3.9142443410150957`*^9}, {
   3.9142443880990477`*^9, 3.914244454028988*^9}, 3.914244617102988*^9, {
   3.91424476899011*^9, 3.914244769394414*^9}, {3.914245039929007*^9, 
   3.914245067387306*^9}, {3.914419499279234*^9, 3.9144195018138523`*^9}, {
   3.914419593389606*^9, 3.91441962543116*^9}, {3.915366762547799*^9, 
   3.915366762992525*^9}, {3.915379370431733*^9, 3.915379372591853*^9}, {
   3.91538364967043*^9, 
   3.915383650778513*^9}},ExpressionUUID->"b0b8b407-ec23-4895-8742-\
5e5bdf9a4baa"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1062.75, 756.},
WindowMargins->{{110.25, Automatic}, {0, Automatic}},
DockedCells->{},
ShowCellTags->True,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5417a6d3-1cb0-447c-b771-c661a424c523"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "make-contours"->{
  Cell[26368, 604, 43226, 897, 2703, "Input",ExpressionUUID->"3253bf76-164a-490e-a0d4-bcaab2ab13d2",
   CellTags->"make-contours"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"make-contours", 74547, 1623}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 457, 8, 68, "Section",ExpressionUUID->"9f8841a8-8249-4f47-9d55-d95cc146c0e1"],
Cell[CellGroupData[{
Cell[1062, 34, 293, 4, 45, "Subsubsection",ExpressionUUID->"519384ab-5ac3-490a-ad9d-5bb2de8040a7"],
Cell[1358, 40, 684, 14, 173, "Text",ExpressionUUID->"014379ae-42bf-4be7-bb3c-9629767445a6"]
}, Closed]],
Cell[CellGroupData[{
Cell[2079, 59, 162, 3, 37, "Subsubsection",ExpressionUUID->"2c40b424-c9f6-4b94-9b1c-ae24b2b092e4"],
Cell[2244, 64, 1478, 24, 173, "Text",ExpressionUUID->"9983541e-6292-4630-97dc-e2e68b752b6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3759, 93, 398, 7, 45, "Subsubsection",ExpressionUUID->"94e934e5-f4d3-4966-865f-84d12904cdeb"],
Cell[4160, 102, 4410, 100, 417, "Input",ExpressionUUID->"bbc363e6-aa4c-4ecc-94c7-18f0dc84cfd9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[8607, 207, 731, 12, 37, "Subsubsection",ExpressionUUID->"bcf1db58-0c2a-43cd-a28e-7e8276321f48"],
Cell[9341, 221, 1369, 30, 92, "Input",ExpressionUUID->"27727f97-7dd2-4d31-a480-915518d89fa6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10747, 256, 221, 4, 45, "Subsubsection",ExpressionUUID->"75efccdb-433b-44b3-bce7-04474ffb7b28"],
Cell[10971, 262, 1013, 17, 104, "Text",ExpressionUUID->"1a733974-8874-4389-ae0e-5d50ad9526c9"],
Cell[11987, 281, 2126, 36, 71, "Input",ExpressionUUID->"7c93945d-8de1-46ed-a1a4-c61b48e539fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14150, 322, 341, 6, 45, "Subsubsection",ExpressionUUID->"9c626022-0b9e-44c8-a361-6a98114ac4e3"],
Cell[14494, 330, 656, 15, 104, "Text",ExpressionUUID->"59599e13-d1cf-462b-bbe8-32509a143740"],
Cell[15153, 347, 1212, 29, 113, "Input",ExpressionUUID->"0abb2362-608b-45fe-815c-a471151abbce"],
Cell[16368, 378, 831, 17, 51, "Input",ExpressionUUID->"d5124485-bfe2-49eb-b48c-48b720893e62"],
Cell[17202, 397, 357, 7, 35, "Text",ExpressionUUID->"c8055252-4875-42f7-b31f-d9e8aeecb6c4"],
Cell[17562, 406, 1003, 25, 51, "Input",ExpressionUUID->"0aa3a6fb-5d26-479b-aa05-222f6112b3f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18602, 436, 184, 3, 45, "Subsubsection",ExpressionUUID->"e635bf7a-668d-49ba-91ee-1e6894635051"],
Cell[18789, 441, 3065, 62, 449, "Text",ExpressionUUID->"4e4e8640-33d1-4448-8d54-e01fb24bb6cd"],
Cell[21857, 505, 4029, 83, 195, "Input",ExpressionUUID->"b27ef285-598a-4623-a18a-d795fbaa85fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25923, 593, 442, 9, 45, "Subsubsection",ExpressionUUID->"b226dcc2-666f-4203-ac2a-2c8e7321c55a"],
Cell[26368, 604, 43226, 897, 2703, "Input",ExpressionUUID->"3253bf76-164a-490e-a0d4-bcaab2ab13d2",
 CellTags->"make-contours"]
}, Closed]],
Cell[CellGroupData[{
Cell[69631, 1506, 232, 4, 37, "Subsubsection",ExpressionUUID->"fd91ba99-4141-41a5-8a4c-9a02c7c502ae"],
Cell[69866, 1512, 392, 8, 41, "Output",ExpressionUUID->"db76cb3e-4de3-4ab2-873e-ee787b0c7771"],
Cell[70261, 1522, 1239, 25, 71, "Input",ExpressionUUID->"9ac83f03-5ba4-4c63-9948-ab4f1efd4b57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71537, 1552, 198, 3, 45, "Subsubsection",ExpressionUUID->"338c4151-30dc-4fc9-a058-d49712d9d719"],
Cell[71738, 1557, 467, 7, 35, "Text",ExpressionUUID->"169bb6c1-81c3-4fb9-874c-462926e4a6c8"],
Cell[72208, 1566, 1918, 40, 92, "Input",ExpressionUUID->"b0b8b407-ec23-4895-8742-5e5bdf9a4baa"]
}, Open  ]]
}, Open  ]]
}
]
*)

